@model List<DishesDbModel>
@{
    ViewData["Title"] = "Edit Dish";
}

<table id="DishEditTable" class="table table-bordered table-striped table-hover">
    <thead class="text-info">
        <tr>
            <th>Name</th>
            <th>Beef</th>
            <th>Pork</th>
            <th>Chicken</th>
            <th>Veggie</th>
            <th>Fish</th>
            <th>Suppe</th>
            <th>Optionen</th>
        </tr>
    </thead>
    <tbody>
        @foreach (DishesDbModel dishesDbModel in Model)
        {
            bool beef = dishesDbModel.Beef;
            <tr>
                <td>@dishesDbModel.NameOfDish</td>
                <td id="Beef">
                    @if (dishesDbModel.Beef == true)
                    {
                        <img src="~/Assets/Icons/True.svg" alt="Not True but ok with that" width="20" height="20" />
                    }
                    else
                    {
                        <img src="~/Assets/Icons/False.svg" alt="Not True but ok with that" width="20" height="20" />
                    }
                </td>
                <td id="Pork">
                    @if (dishesDbModel.Pork == true)
                    {
                        <img src="~/Assets/Icons/True.svg" alt="Not True but ok with that" width="20" height="20" />
                    }
                    else
                    {
                        <img src="~/Assets/Icons/False.svg" alt="Not True but ok with that" width="20" height="20" />
                    }
                </td>
                <td id="Chicken">
                    @if (dishesDbModel.Chicken == true)
                    {
                        <img src="~/Assets/Icons/True.svg" alt="Not True but ok with that" width="20" height="20" />
                    }
                    else
                    {
                        <img src="~/Assets/Icons/False.svg" alt="Not True but ok with that" width="20" height="20" />
                    }
                </td>
                <td id="Veggie">
                    @if (dishesDbModel.Veggie == true)
                    {
                        <img src="~/Assets/Icons/True.svg" alt="Not True but ok with that" width="20" height="20" />
                    }
                    else
                    {
                        <img src="~/Assets/Icons/False.svg" alt="Not True but ok with that" width="20" height="20" />
                    }
                </td>
                <td id="Fish">
                    @if (dishesDbModel.Fish == true)
                    {
                        <img src="~/Assets/Icons/True.svg" alt="Not True but ok with that" width="20" height="20" />
                    }
                    else
                    {
                        <img src="~/Assets/Icons/False.svg" alt="Not True but ok with that" width="20" height="20" />
                    }
                </td>
                <td id="Soup">
                    @if (dishesDbModel.Soup == true)
                    {
                        <img src="~/Assets/Icons/True.svg" alt="Not True but ok with that" width="20" height="20" />
                    }
                    else
                    {
                        <img src="~/Assets/Icons/False.svg" alt="Not True but ok with that" width="20" height="20" />
                    }
                </td>
                <td id="Options">
                    <a asp-route-id="@dishesDbModel.Id" asp-controller="UniEatAdmin" asp-action="CreateEditDishes" class="btn btn-warning">Bearbeiten</a>
                    <button onclick="onClickedDeleteButton(@dishesDbModel.Id)" class="btn btn-danger">Löschen</button>
                </td>
            </tr>
        }
    </tbody>

</table>
<form>
<button class="btn btn-danger" asp-controller="UniEatAdmin" asp-action="Index">Zurück</button>
</form>

@section Scripts {
    <script>
        let table = new DataTable('#DishEditTable');

        function onClickedDeleteButton(Id) {
            Swal.fire({
                title: "Bist du dir Sicher?",
                text: "Das kann nicht Rückgängig gemacht werden!",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#3085d6",
                cancelButtonColor: "#d33",
                cancelButtonText: "Abbrechen",
                confirmButtonText: "Ja, tu es!"
            }).then((result) => {
                if (result.isConfirmed) {
                    // Backend call delete by ID
                    $.ajax({
                        type: "POST",
                        url: "@Url.Action("DeleteDish")",
                        data: { Id: Id },
                        success: function (msg) {
                            Swal.fire({
                                title: "Gelöscht!",
                                text: "Der Eintrag wurde Gelöscht.",
                                icon: "success"
                            }).then((result) => {
                                location.reload();
                            });
                        },
                        error: function (msg) {
                            Swal.fire({
                                title: "Error",
                                text: "Da ist ein Fehler passiert",
                                icon: "error"
                            })
                        },
                    });
                }
            });
        }
    </script>
}
